#include <stdio.h>
#include <stdlib.h>  // 包含malloc、free、NULL的定义

int main() {
    int size = 5;  // 数组长度（可运行时动态修改，如scanf("%d", &size)）
    
    // 1. 动态分配内存
    int *dynamicArray = (int *)malloc(size * sizeof(int));
    
    // 2. 关键：检查内存是否分配成功（堆内存可能耗尽）
    if (dynamicArray == NULL) {
        printf("内存分配失败！\n");
        return 1;  // 退出程序，避免后续非法访问
    }
    
    // 3. 使用动态数组（和普通数组用法一致，通过指针偏移或下标访问）
    for (int i = 0; i < size; i++) {
        dynamicArray[i] = i * 10;  // 下标访问：给数组赋值 0,10,20,30,40
        // 等价于：*(dynamicArray + i) = i * 10; （指针偏移访问）
    }
    
    // 打印数组内容
    for (int i = 0; i < size; i++) {
        printf("dynamicArray[%d] = %d\n", i, dynamicArray[i]);
    }
    
    // 4. 关键：使用完后释放内存（避免内存泄漏）
    free(dynamicArray);  // 释放堆内存空间
    dynamicArray = NULL;  // 避免野指针（释放后指针仍指向原地址，置空后访问会报错，便于调试）
    
    return 0;
}
